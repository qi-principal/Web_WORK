# 广告平台项目框架说明

## 项目结构

```
src/
├── main/
│   ├── java/
│   │   └── com/
│   │       └── adplatform/
│   │           ├── AdPlatformApplication.java (应用程序入口)
│   │           ├── common/ (公共组件)
│   │           │   ├── exception/
│   │           │   │   ├── ApiException.java
│   │           │   │   ├── BusinessException.java
│   │           │   │   └── GlobalExceptionHandler.java
│   │           │   └── response/
│   │           │       ├── Result.java
│   │           │       └── ResultCode.java
│   │           └── module/ (业务模块)
│   │               ├── ad/ (广告相关模块)
│   │               │   ├── controller/
│   │               │   ├── service/
│   │               │   ├── entity/
│   │               │   ├── dto/
│   │               │   ├── enums/
│   │               │   └── converter/
│   │               ├── config/ (配置相关模块)
│   │               │   └── SwaggerConfig.java
│   │               ├── user/ (用户相关模块)
│   │               │   ├── controller/
│   │               │   ├── service/
│   │               │   ├── entity/
│   │               │   ├── dto/
│   │               │   ├── security/
│   │               │   └── exception/
│   │               └── website/ (网站相关模块)
│   │                   ├── controller/
│   │                   ├── service/
│   │                   ├── entity/
│   │                   ├── dto/
│   │                   └── security/
│   └── resources/
│       ├── application.yml (应用配置文件)
│       ├── db/ (数据库相关文件)
│       │   ├── init.sql (初始化SQL)
│       │   ├── maintenance.sql (维护SQL)
│       │   ├── website_model_init.sql (网站模块初始化)
│       │   └── migration/ (数据库迁移脚本)
│       └── static/ (静态资源文件)
│           ├── index.html (主页面)
│           ├── css/ (样式文件)
│           ├── js/ (JavaScript文件)
│           ├── material/ (素材文件)
│           └── advertisement/ (广告资源)
└── test/ (测试目录)
    ├── java/
    │   └── com/
    │       └── adplatform/
    │           └── module/ (模块测试)
    └── resources/ (测试资源)
```

## 目录说明

1. **src/main/java**: Java源代码目录
   - `com.adplatform`: 项目主包名
   - `AdPlatformApplication.java`: Spring Boot应用程序入口类
   - `common`: 存放公共组件、工具类、通用配置等
     - `exception/`: 异常处理相关类
       - `ApiException.java`: API异常基类
       - `BusinessException.java`: 业务异常类
       - `GlobalExceptionHandler.java`: 全局异常处理器
     - `response/`: 统一响应处理
       - `Result.java`: 统一响应结果封装类
       - `ResultCode.java`: 响应状态码枚举类
   - `module`: 存放各个业务模块的代码

2. **src/main/resources**: 资源文件目录
   - `application.yml`: 应用程序主配置文件，包含数据库连接、服务器配置等
   - `db`: 数据库相关文件，如SQL脚本、数据库迁移文件等
   - `static`: 静态资源文件，如CSS、JavaScript、图片等

3. **src/test**: 测试代码目录
   - 用于存放单元测试、集成测试等测试代码

## 资源目录说明

### 1. 数据库资源 (resources/db/)
- **init.sql**
  - 数据库初始化脚本
  - 包含表结构和基础数据
- **maintenance.sql**
  - 数据库维护脚本
  - 用于系统维护和修复
- **website_model_init.sql**
  - 网站模块初始化脚本
  - 网站相关表结构和数据
- **migration/**
  - 数据库迁移脚本目录
  - 版本控制和升级脚本

### 2. 静态资源 (resources/static/)
- **index.html**
  - 应用主页面
  - 前端入口文件
- **css/**
  - 样式文件目录
  - 页面布局和样式定义
- **js/**
  - JavaScript文件目录
  - 前端交互逻辑
- **material/**
  - 广告素材存储目录
  - 图片、视频等媒体文件
- **advertisement/**
  - 广告资源目录
  - 广告相关静态资源

### 3. 测试资源
- **test/java/**
  - 测试代码目录
  - 单元测试和集成测试
- **test/resources/**
  - 测试配置文件
  - 测试数据和资源

## 技术栈

- 核心框架：Spring Boot
- 项目管理：Maven
- 开发语言：Java

## 项目特点

1. 采用标准的Maven项目结构
2. 遵循Spring Boot最佳实践
3. 模块化设计，便于扩展和维护
4. 清晰的目录结构，便于代码管理 

## 公共组件说明

### 1. 异常处理模块 (exception/)

#### GlobalExceptionHandler
- 全局异常处理器，统一处理系统中的各类异常
- 使用 `@RestControllerAdvice` 注解，实现全局异常拦截
- 主要处理以下类型异常：
  - 业务异常 (BusinessException)
  - API异常 (ApiException)
  - 参数校验异常 (MethodArgumentNotValidException)
  - 参数绑定异常 (BindException)
  - 其他未知异常

#### BusinessException & ApiException
- 自定义异常类，用于规范化异常处理
- BusinessException: 处理业务逻辑相关异常
- ApiException: 处理API调用相关异常

### 2. 响应处理模块 (response/)

#### Result<T>
- 统一响应结果封装类
- 支持泛型，可以返回任意类型的数据
- 提供了多种静态工厂方法：
  - success(): 成功响应
  - error(): 错误响应
  - validateFailed(): 参数验证失败
  - unauthorized(): 未授权响应
  - forbidden(): 禁止访问响应

#### ResultCode
- 响应状态码枚举类
- 定义了常用的HTTP响应状态码：
  - 200: 操作成功
  - 400: 参数错误
  - 401: 未授权
  - 403: 禁止访问
  - 405: 不支持的请求方法
  - 408: 请求超时
  - 500: 服务器内部错误
 
## 业务模块说明

### 1. 用户模块 (user/)

#### 1.1 控制器层 (controller/)
- **AuthController.java**
  - 处理用户认证相关请求
  - 包含登录、注册等接口
- **UserController.java**
  - 处理用户信息相关请求
  - 用户信息的CRUD操作

#### 1.2 服务层 (service/)
- **UserService.java**
  - 用户服务接口定义
- **impl/UserServiceImpl.java**
  - 用户服务接口实现
  - 包含具体的业务逻辑处理

#### 1.3 实体层 (entity/)
- **User.java**
  - 用户实体类
  - 对应数据库用户表
- **Role.java**
  - 角色实体类
  - 定义用户角色信息
- **UserRole.java**
  - 用户-角色关联实体类
  - 实现用户和角色的多对多关系

#### 1.4 数据传输对象 (dto/)
- **LoginRequest.java**
  - 登录请求参数封装
- **LoginResponse.java**
  - 登录响应数据封装
- **RegisterRequest.java**
  - 注册请求参数封装
- **UserDTO.java**
  - 用户信息传输对象

#### 1.5 安全模块 (security/)
- **SecurityConfig.java**
  - Spring Security配置类
  - 配置安全规则、认证方式等
- **JwtTokenProvider.java**
  - JWT令牌生成和验证
- **JwtAuthenticationFilter.java**
  - JWT认证过滤器
- **SecurityService.java**
  - 安全相关服务
- **UserDetailsServiceImpl.java**
  - 用户详情服务实现
- **UserPrincipal.java**
  - 用户认证主体对象

#### 1.6 功能特点
1. **完整的用户认证体系**
   - 基于JWT的token认证
   - 角色基础的权限控制
   - 安全的密码加密存储

2. **用户管理功能**
   - 用户注册
   - 用户登录
   - 用户信息管理
   - 角色权限管理

3. **安全特性**
   - 全局统一的安全配置
   - 灵活的权限控制
   - 安全的令牌管理

### 2. 广告模块 (ad/)

#### 2.1 控制器层 (controller/)
- **AdvertisementController.java**
  - 广告管理相关接口
  - 广告的创建、修改、查询、删除等操作
- **MaterialController.java**
  - 广告素材管理接口
  - 素材的上传、管理等功能

#### 2.2 服务层 (service/)
- **AdvertisementService.java**
  - 广告业务接口定义
  - 广告的核心业务逻辑
- **MaterialService.java**
  - 素材服务接口定义
  - 素材管理相关功能
- **OssService.java**
  - 对象存储服务接口
  - 处理文件上传存储
- **impl/**
  - 各服务接口的具体实现类

#### 2.3 实体层 (entity/)
- **Advertisement.java**
  - 广告实体类
  - 对应广告数据表
- **Material.java**
  - 素材实体类
  - 存储广告素材信息
- **AdMaterialRelation.java**
  - 广告-素材关联实体
  - 实现广告和素材的关联关系

#### 2.4 数据传输对象 (dto/)
- **AdvertisementDTO.java**
  - 广告信息传输对象
- **MaterialDTO.java**
  - 素材信息传输对象
- **AdCreateRequest.java**
  - 广告创建请求参数封装

#### 2.5 枚举类 (enums/)
- **AdType.java**
  - 广告类型枚举
  - 定义不同的广告类型
- **AdStatus.java**
  - 广告状态枚举
  - 广告的生命周期状态
- **MaterialType.java**
  - 素材类型枚举
  - 支持的素材类型定义

#### 2.6 功能特点
1. **广告管理系统**
   - 广告的完整生命周期管理
   - 支持多种广告类型
   - 灵活的状态控制

2. **素材管理系统**
   - 多类型素材支持
   - 云存储集成
   - 素材与广告关联管理

3. **业务特性**
   - 完整的广告投放流程
   - 素材存储云服务集成
   - 广告状态自动化管理

### 3. 网站模块 (website/)
- `controller/`: 控制器层
- `converter/`: 对象转换器
- `dto/`: 数据传输对象
- `entity/`: 实体类
- `enums/`: 枚举类
- `mapper/`: MyBatis映射器
- `security/`: 安全相关实现
- `service/`: 业务逻辑层

### 4. 配置模块 (config/)
- `SwaggerConfig.java`: Swagger API文档配置

## 模块分层说明

1. **表现层 (Controller)**
   - 处理HTTP请求和响应
   - 参数校验和转换
   - 调用服务层处理业务逻辑

2. **业务层 (Service)**
   - 实现具体的业务逻辑
   - 事务管理
   - 调用数据访问层进行数据操作

3. **数据访问层 (Mapper/Repository)**
   - 与数据库交互
   - 实现数据的CRUD操作
   - 使用MyBatis进行对象关系映射

4. **实体层 (Entity/DTO)**
   - Entity: 数据库表对应的实体类
   - DTO: 数据传输对象，用于层间数据传递
   - Converter: 实体对象与DTO之间的转换

5. **通用组件**
   - Enums: 枚举类定义
   - Config: 模块配置类
   - Security: 安全相关实现
   - Exception: 异常处理
 